pipeline {
    agent any 

    stages {
        // Étape 1 : Installation des dépendances pour le back et le front
        stage('Install dependencies') {
            steps {
                script {
                    sh 'cd LavoroBack && npm install'  //  Installe les dépendances du backend
                    sh 'cd LavoroFront && npm install' //  Installe les dépendances du frontend
                }
            }
        }

        // Étape 2 : Exécution des tests unitaires (Back uniquement si nécessaire)
        stage('Unit Test') {
            steps {
                script {
                    sh 'cd LavoroBack && npm test'
                }
            }
        }

        // Étape 3 : Construction de l'application (Front et Back)
        stage('Build application') {
            steps {
                script {
                    sh 'cd LavoroBack && npm run build-dev'  //  Build du backend
                    sh 'cd LavoroFront && npm run build'     // Build du frontend (ajustez selon votre script)
                }
            }
        }
    }
}
